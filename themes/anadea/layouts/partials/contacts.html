<section class="contacts">
  <div class="contacts__content">
    <div>
      <svg class="contacts__logo" width="68" height="54" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M33.794 0 0 11.977v20.688l33.794-11.977 33.795 11.977V11.977L33.794 0ZM0 53.687 3.112 46h1.472l3.112 7.687h-1.67l-.664-1.712h-3.07l-.663 1.712H0Zm3.827-5.672-.965 2.474h1.93l-.965-2.474ZM17.985 50.732 14.506 46H13v7.687h1.612v-4.889l3.596 4.889h1.389V46h-1.612v4.732ZM25 53.687 28.11 46h1.475l3.11 7.687h-1.668l-.665-1.712h-3.07l-.663 1.712H25Zm3.826-5.672-.963 2.474h1.928l-.965-2.474ZM37 46h2.792c2.25 0 3.804 1.659 3.804 3.842 0 2.164-1.554 3.845-3.804 3.845H37V46Zm1.573 6.16h1.219c1.29 0 2.158-.934 2.158-2.318 0-1.36-.869-2.317-2.158-2.317h-1.219v4.634ZM50.578 50.568h3.402v-1.503h-3.402v-1.56h3.867V46H49v7.687h5.497v-1.504h-3.919v-1.615ZM63.113 46h1.472l3.11 7.687h-1.667l-.666-1.712h-3.068l-.666 1.712H60L63.113 46Zm.713 2.014-.963 2.475h1.927l-.964-2.474Z"
          fill="#fff"
        />
      </svg>
      <h2 class="contacts__title">Contact us</h2>
      <p class="contacts__paragraph">
        Whether youâ€™re looking to build an MVP, create a web design for your site, develop a mobile app or complex IT
        system - tell us about your project. We will give you a quote and advice.
      </p>
    </div>
  </div>
  <div class="contacts__formBlock">
    <form class="contacts__form" id="contact_form" enctype="multipart/form-data" accept-charset="UTF-8" >
      <input
      type="hidden"
      name="contact_type"
      id="bottom_section_contact_type"
      value="contact_form"
      autocomplete="off"
    />
    <input
      type="hidden"
      name="guid"
      id="bottom_section_guid"
      value="GA1.1.1857433846.1718106450"
      autocomplete="off"
    />
      <div class="contacts__item">
        <label for="name">Your name*</label>
        <input class="contacts__input" id="name" required="required" aria-required="true" type="text" name="name" />
      </div>
      <div class="contacts__item">
        <label for="email">Your E-mail*</label>
        <input class="contacts__input" id="email" required="required" aria-required="true" type="email" name="email" />
      </div>
      <div class="contacts__item">
        <label for="phone">Phone number</label>
        <input class="contacts__input" id="phone" name="phone" type="tel" />
      </div>
      <textarea class="contacts__item contacts__textarea" placeholder="Description*" minlength="20" required="required" aria-required="true" name="message"></textarea>
      <label class="contacts__label contacts__label--attach" id="file-label" for="file">Attach file</label>
      <input class="contacts__file" id="file" multiple="multiple" data-size="500" type="file" name="attachments[]" onchange="handleFileInputChange(event)" />
      <div class="contacts__subscribe">
        <input name="subscribe" type="hidden" value="0" autocomplete="off" />
        <input class="contacts__checkbox" type="checkbox" name="subscribe" value="1" id="subscribe" checked />
        <label for="subscribe">Sign me up to newsletter - Useful insights only and frequency just right.</label>
      </div>
      <button class="contacts__submit" type="submit" data-disable-with="Sending...">Send</button>
    </form>
  </div>
</section>

<script>
  function truncateText(text, maxLength) {
    if (text.length > maxLength) {
      return text.substring(0, maxLength) + '...';
    }
    return text;
  }

  document.getElementById('file').addEventListener('change', function(event) {
    const fileLabel = document.getElementById('file-label');
    const fileName = event.target.files[0].name;
    fileLabel.textContent = truncateText(fileName, 20);
  });

  function handleFileInputChange(event) {
    const label = document.querySelector('.contacts__label');

    if (event.target.files.length > 0) {
      label.textContent = `${event.target.files[0].name}`;
    } else {
      label.textContent = 'Attach file';
    }
  }

  function handleSubmit(e) {
    e.preventDefault();
    const formData = new FormData(this);
    
    if(document.getElementsByName('first_url').length == 0) {
      var input = document.createElement("input");
      input.setAttribute("type", "hidden");
      input.setAttribute("name", "first_url");
      input.setAttribute("value", localStorage.getItem("first-url"));
      document.getElementById("contact_form").appendChild(input);
      localStorage.removeItem("first-url");
    }

    uploadMultiple(formData);
  }

  function uploadMultiple(formData) {
    fetch("https://anadea.info/webhooks/blog_contacts/some_cool_token", {
        body: formData,
        method: "POST",
      }).then(response => {
        console.log(response)
      })
  }

  document.getElementById('contact_form').addEventListener('submit', handleSubmit)
</script>

<script type="application/javascript ">
  (function() {
    fetch('https://api.ipify.org?format=json').then(function (response) {
      return response.json();
    }).then(function (json) {
      var input = document.createElement("input");
      input.setAttribute("type", "hidden");
      input.setAttribute("name", "remote_ip");
      input.setAttribute("value", json.ip);
      document.getElementById("contact_form").appendChild(input);
    }).catch(function (err) {
      console.error("Error getting IP Address: ".concat(err));
    });
  })();
</script>

<script type="application/javascript ">
  (function() {
    function initGTMLisner() {
      if(window.dataLayer) {
        var oldPush = window.dataLayer.push;
        window.dataLayer.push = function() {
          oldPush.apply(window.dataLayer, arguments)
          if (arguments[0].hasOwnProperty('h') && (arguments[0]['h'].hasOwnProperty('event')) && arguments[0]['h']['event'] === "gtagApiGet") {
            var client_id = arguments[0]['h']['gtagApiResult']['client_id']
            if(document.getElementsByName('gclid').length == 0) {
              var input = document.createElement("input");
              input.setAttribute("type", "hidden");
              input.setAttribute("name", "gclid");
              input.setAttribute("value", client_id);
              document.getElementById("contact_form").appendChild(input);
            }
          }
        }
      }
    }
    initGTMLisner();
  })();
</script>

<script type="application/javascript ">
  (function() {
    var input = document.createElement("input");
    input.setAttribute("type", "hidden");
    input.setAttribute("name", "referer_url");
    input.setAttribute("value", document.referrer);
    document.getElementById("contact_form").appendChild(input);
  })();
</script>

<script type="application/javascript ">
  (function() {
    if (!("first-url" in localStorage)) {
        localStorage.setItem("first-url", window.location.href)
    }
  })();
</script>